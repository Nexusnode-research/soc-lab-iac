# Syslog UDP input from OPNsense/Zenarmor
[source::udp:5514]
# (keep your Suricata transform) + teach Splunk to tag Zenarmor & drop {"index":{}} lines
TRANSFORMS-opnsense-st = set_suricata,set_zenarmor_prefixed,set_zenarmor_bare,drop_zen_index_prefixed,drop_zen_index_bare

# Zenarmor events
[zenarmor]
SHOULD_LINEMERGE = false
TRUNCATE         = 0

# Strip everything up to (and including) the "zenarmor:" marker
# so _raw becomes pure JSON -> KV_MODE=json works.
SEDCMD:to_json = s/^.*zenarmor:\s*// 

# Parse JSON at search time
KV_MODE    = json

# Use the IPDR event time
TIME_PREFIX = "start_time":
TIME_FORMAT = %s%3N
