# (keep your existing set_suricata if you already have one)
[set_suricata]
REGEX = suricata:\s*\{
FORMAT = sourcetype::suricata
DEST_KEY = MetaData:Sourcetype

# Zenarmor lines that are already bare JSON (in case you later remove the prefix on the sender)
[set_zenarmor_bare]
REGEX = ^\{
FORMAT = sourcetype::zenarmor
DEST_KEY = MetaData:Sourcetype

# Drop the companion {"index":{}} lines (prefixed form)
[drop_zen_index_prefixed]
REGEX = ^.*zenarmor:\s*\{"index":\{\}\}\s*$
DEST_KEY = queue
FORMAT = nullQueue

# Drop the companion {"index":{}} lines (bare form)
[drop_zen_index_bare]
REGEX = ^\{"index":\{\}\}\s*$
DEST_KEY = queue
FORMAT = nullQueue
